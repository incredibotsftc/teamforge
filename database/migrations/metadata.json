{
  "$schema": "https://json-schema.org/draft-07/schema",
  "description": "Migration metadata that maps app versions to migration files and release notes",
  "migrations": {
    "1.0.0": {
      "migration": "0001_init.sql",
      "releaseNotes": "/releases/v1.0.0.md",
      "description": "Initial baseline release with all core features",
      "requiresVerification": false,
      "verificationScript": null,
      "estimatedTime": "2-3 minutes",
      "dependencies": []
    },
    "1.1.0": {
      "migration": "0002_add_version_tracking.sql",
      "releaseNotes": "/releases/v1.1.0.md",
      "description": "Add version tracking and vendor management",
      "requiresVerification": true,
      "verificationScript": "SELECT EXISTS (SELECT FROM information_schema.tables WHERE table_name = 'schema_versions') AS schema_versions_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_name = 'migration_history') AS migration_history_exists, EXISTS (SELECT FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid WHERE n.nspname = 'public' AND p.proname = 'get_current_db_version') AS get_current_db_version_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_name = 'vendors') AS vendors_table_exists, EXISTS (SELECT FROM information_schema.columns WHERE table_name = 'expenses' AND column_name = 'vendor_id') AS vendor_id_column_exists;",
      "estimatedTime": "45 seconds",
      "dependencies": ["1.0.0"]
    },
    "1.2.0": {
      "migration": "0003_add_scouting_sheets.sql",
      "releaseNotes": "/releases/v1.2.0.md",
      "description": "Add scouting system with templates and responses",
      "requiresVerification": true,
      "verificationScript": "SELECT EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'scouting_templates') AS scouting_templates_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'scouting_responses') AS scouting_responses_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'scouting_templates_team_season_unique') AS template_unique_constraint_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'scouting_responses_template_fkey') AS template_fkey_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'scouting_responses_team_fkey') AS team_fkey_exists, EXISTS (SELECT FROM pg_indexes WHERE indexname = 'idx_scouting_templates_team_season') AS template_index_exists, EXISTS (SELECT FROM pg_indexes WHERE indexname = 'idx_scouting_responses_team') AS response_team_index_exists, EXISTS (SELECT FROM storage.buckets WHERE id = 'scouting-images') AS storage_bucket_exists, EXISTS (SELECT FROM public.schema_versions WHERE version = '1.2.0') AS version_recorded;",
      "estimatedTime": "45 seconds",
      "dependencies": ["1.1.0"]
    },
    "1.3.0": {
      "migration": "0004_fix_sort_order.sql",
      "releaseNotes": "/releases/v1.3.0.md",
      "description": "Fix sort_order values and add drag-and-drop reordering for notebook pages and folders",
      "requiresVerification": true,
      "verificationScript": "SELECT EXISTS (SELECT FROM schema_versions WHERE version = '1.3.0') AS version_recorded, (SELECT COUNT(*) FROM notebook_pages) = 0 OR (SELECT COUNT(*) FROM notebook_pages WHERE sort_order IS NOT NULL) = (SELECT COUNT(*) FROM notebook_pages) AS pages_sort_order_valid, (SELECT COUNT(*) FROM notebook_folders) = 0 OR (SELECT COUNT(*) FROM notebook_folders WHERE sort_order IS NOT NULL) = (SELECT COUNT(*) FROM notebook_folders) AS folders_sort_order_valid;",
      "estimatedTime": "5-10 seconds",
      "dependencies": ["1.2.0"]
    },
    "1.4.0": {
      "migration": "0005_add_surveys.sql",
      "releaseNotes": "/releases/v1.4.0.md",
      "description": "Add surveys feature with public response collection and analytics",
      "requiresVerification": true,
      "verificationScript": "SELECT EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'surveys') AS surveys_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'survey_questions') AS survey_questions_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'survey_responses') AS survey_responses_exists, EXISTS (SELECT FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'survey_answers') AS survey_answers_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'surveys_team_fkey') AS surveys_team_fkey_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'survey_questions_survey_fkey') AS questions_survey_fkey_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'survey_responses_survey_fkey') AS responses_survey_fkey_exists, EXISTS (SELECT FROM pg_constraint WHERE conname = 'survey_answers_response_fkey') AS answers_response_fkey_exists, EXISTS (SELECT FROM pg_indexes WHERE indexname = 'idx_surveys_team_season') AS surveys_team_season_index_exists, EXISTS (SELECT FROM pg_indexes WHERE indexname = 'idx_survey_questions_survey') AS questions_survey_index_exists, EXISTS (SELECT FROM pg_policies WHERE tablename = 'surveys' AND policyname = 'Team members can view their team''s surveys') AS surveys_select_policy_exists, EXISTS (SELECT FROM pg_policies WHERE tablename = 'survey_responses' AND policyname = 'Anyone can submit responses to published surveys') AS public_submit_policy_exists, EXISTS (SELECT FROM pg_proc p JOIN pg_namespace n ON p.pronamespace = n.oid WHERE n.nspname = 'public' AND p.proname = 'get_surveys_with_question_count') AS helper_function_exists, EXISTS (SELECT FROM public.schema_versions WHERE version = '1.4.0') AS version_recorded;",
      "estimatedTime": "1 minute",
      "dependencies": ["1.3.0"]
    }
  },
  "versionOrder": ["1.0.0", "1.1.0", "1.2.0", "1.3.0", "1.4.0"]
}
